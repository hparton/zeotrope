"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Zoetrope=function(){function Zoetrope(options){_classCallCheck(this,Zoetrope),this._duration=options&&options.duration?options.duration:1e3,this._running=!0,this._startedAt=null,this._pausedAt=null,this._handlers=[],this._easingFunc=options&&options.easing?options.easing:easeOutQuart,this._rafID=null,options&&options.onStart&&this.on("start",options.onStart),options&&options.onComplete&&this.on("complete",options.onComplete),options&&options.onTick&&this.on("tick",options.onTick),this._polyfillDateNow(),this._polyfillRAF()}return _createClass(Zoetrope,[{key:"duration",value:function(_duration){return this._duration=_duration,this}},{key:"easing",value:function(easingFunc){return this._easingFunc=easingFunc,this}},{key:"play",value:function(reversed){return null===this._startedAt&&(this.dispatch("start"),this._run(this._setStartTime(),reversed)),this}},{key:"reverse",value:function(){return this.play(!0),this}},{key:"pause",value:function(){return this._running=!1,this._pausedAt=this._getNow(),this}},{key:"resume",value:function(){return this._running||(this._running=!0,this._startedAt=this._startedAt+(this._getNow()-this._pausedAt)),this}},{key:"stop",value:function(){return window.cancelAnimationFrame(this._rafID),this._startedAt=null,this}},{key:"loop",value:function(delay){var _this=this;delay||(delay=0);var i=0;return this.play(),this.on("complete",function(){setTimeout(function(){i%2==0?_this.reverse():_this.play(),i++},delay)}),this}},{key:"_run",value:function(timestamp,reversed){var _this2=this;if(this._running){var runtime=timestamp-this._startedAt,progress=runtime/this._duration;progress=Math.min(progress,1),reversed&&(progress=1-progress),progress=this._easingFunc(progress),this.dispatch("tick",progress),runtime<=this._duration?this._rafID=window.requestAnimationFrame(function(timestamp){_this2._run(timestamp,reversed)}):(this._startedAt=null,this.dispatch("complete"))}else window.requestAnimationFrame(function(timestamp){_this2._run(timestamp,reversed)})}},{key:"dispatch",value:function(event,params){for(var i=0;i<this._handlers.length;i++)this._handlers[i].event===event&&this._handlers[i].cb(params)}},{key:"on",value:function(event,cb){return this._handlers.push({event:event,cb:cb}),this}},{key:"_setStartTime",value:function(cb){return this._startedAt=this._getNow(),this._startedAt}},{key:"_getNow",value:function(){return window.performance&&window.performance.now?window.performance.now():Date.now()}},{key:"debug",value:function(log){return(void 0===log||log)&&console.log(Object.assign({},this)),this}},{key:"_polyfillDateNow",value:function(){Date.now||(Date.now=function(){return(new Date).getTime()})}},{key:"_polyfillRAF",value:function(){for(var _this3=this,vendors=["webkit","moz"],i=0;i<vendors.length&&!window.requestAnimationFrame;++i){var vp=vendors[i];window.requestAnimationFrame=window[vp+"RequestAnimationFrame"],window.cancelAnimationFrame=window[vp+"CancelAnimationFrame"]||window[vp+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var lastTime=0;window.requestAnimationFrame=function(callback){var now=_this3._getNow(),nextTime=Math.max(lastTime+16,now);return setTimeout(function(){return callback(lastTime=nextTime)},nextTime-now)},window.cancelAnimationFrame=clearTimeout}}}]),Zoetrope}(),easeOutQuart=function(t){return 1- --t*t*t*t};"undefined"!=typeof module?module.exports=Zoetrope:window.Zoetrope=Zoetrope;